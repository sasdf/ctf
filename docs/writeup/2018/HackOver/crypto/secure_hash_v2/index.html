
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>crypto - secure_hash_v2 Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../../rev/flagmaker/" />
    
    
    <link rel="prev" href="../oblivious/" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../../../">
            
                <a href="../../../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Writeups</li>
        
        
    

    
        
        <li class="header">2020</li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    TWCTF
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../../../../2020/tokyoWesterns/rev/metal/">
            
                <a href="../../../../2020/tokyoWesterns/rev/metal/">
            
                    
                    rev - metal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../../../../2020/tokyoWesterns/crypto/xs/">
            
                <a href="../../../../2020/tokyoWesterns/crypto/xs/">
            
                    
                    crypto - XOR and shift encryptor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                <span>
            
                    
                    Google
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../../../../2020/google/crypto/oracle/">
            
                <a href="../../../../2020/google/crypto/oracle/">
            
                    
                    crypto - Oracle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../../../../2020/google/crypto/yafm/">
            
                <a href="../../../../2020/google/crypto/yafm/">
            
                    
                    crypto - YAFM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../../../../2020/google/crypto/quantum/">
            
                <a href="../../../../2020/google/crypto/quantum/">
            
                    
                    crypto - Quantum Pyramids
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../../../../2020/google/crypto/sharky/">
            
                <a href="../../../../2020/google/crypto/sharky/">
            
                    
                    crypto - SHArky
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">2019</li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    Google
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../../../2019/google/crypto/reality/">
            
                <a href="../../../../2019/google/crypto/reality/">
            
                    
                    crypto - reality
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../../../../2019/google/crypto/qkd/">
            
                <a href="../../../../2019/google/crypto/qkd/">
            
                    
                    crypto - Quantum Key Distribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../../../../2019/google/crypto/cell/">
            
                <a href="../../../../2019/google/crypto/cell/">
            
                    
                    crypto - Reverse a cellular automata
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="../../../../2019/google/hardware/flagrom/">
            
                <a href="../../../../2019/google/hardware/flagrom/">
            
                    
                    hardware - flagrom
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="../../../../2019/google/hardware/minetest/">
            
                <a href="../../../../2019/google/hardware/minetest/">
            
                    
                    hardware - minetest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="../../../../2019/google/hardware/remote/">
            
                <a href="../../../../2019/google/hardware/remote/">
            
                    
                    hardware - Remote Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.7" data-path="../../../../2019/google/web/glotto/">
            
                <a href="../../../../2019/google/web/glotto/">
            
                    
                    web - gLotto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.8" data-path="../../../../2019/google/rev/dial/">
            
                <a href="../../../../2019/google/rev/dial/">
            
                    
                    rev - Dialtone
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" >
            
                <span>
            
                    
                    Plaid
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../../../2019/plaid/crypto/cypress/">
            
                <a href="../../../../2019/plaid/crypto/cypress/">
            
                    
                    crypto - SPlaid Cypress
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../../../2019/plaid/rev/bigmaffs/">
            
                <a href="../../../../2019/plaid/rev/bigmaffs/">
            
                    
                    rev - big maffs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">2018</li>
        
        
    
        <li class="chapter " data-level="5.1" >
            
                <span>
            
                    
                    hxp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../../../hxp/crypto/blinder_v2/">
            
                <a href="../../../hxp/crypto/blinder_v2/">
            
                    
                    crypto - blinder_v2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../../../hxp/crypto/blinder/">
            
                <a href="../../../hxp/crypto/blinder/">
            
                    
                    crypto - blinder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../../../hxp/crypto/curve/">
            
                <a href="../../../hxp/crypto/curve/">
            
                    
                    crypto - curve12833227
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="../../../hxp/crypto/oops/">
            
                <a href="../../../hxp/crypto/oops/">
            
                    
                    crypto - oops2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="../../../hxp/crypto/blind/">
            
                <a href="../../../hxp/crypto/blind/">
            
                    
                    crypto - blind
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" >
            
                <span>
            
                    
                    Pwn2Win
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../../pwn2win/rev/back_to_bletchley_park/">
            
                <a href="../../../pwn2win/rev/back_to_bletchley_park/">
            
                    
                    cryrev - Back To Bletchley Park
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../../../pwn2win/crypto/GCM/">
            
                <a href="../../../pwn2win/crypto/GCM/">
            
                    
                    crypto - GCM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" >
            
                <span>
            
                    
                    HITCON
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../../../hitcon/crypto/lostmod/">
            
                <a href="../../../hitcon/crypto/lostmod/">
            
                    
                    crypto - Lost Modulus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.2" data-path="../../../hitcon/crypto/secret/">
            
                <a href="../../../hitcon/crypto/secret/">
            
                    
                    crypwn - Secret Note
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.4" >
            
                <span>
            
                    
                    Hack.lu
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.4.1" data-path="../../../Hack.lu/crypto/escape/">
            
                <a href="../../../Hack.lu/crypto/escape/">
            
                    
                    crypto - Escape the Grid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4.2" data-path="../../../Hack.lu/crypto/relation/">
            
                <a href="../../../Hack.lu/crypto/relation/">
            
                    
                    crypto - Relations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4.3" data-path="../../../Hack.lu/crypto/lfsr/">
            
                <a href="../../../Hack.lu/crypto/lfsr/">
            
                    
                    crypto - LFSR StreamCipher
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.4.3.1" data-path="../../../Hack.lu/crypto/lfsr/task.html">
            
                <a href="../../../Hack.lu/crypto/lfsr/task.html">
            
                    
                    task description
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.5" >
            
                <span>
            
                    
                    Hackover
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.5.1" data-path="../oblivious/">
            
                <a href="../oblivious/">
            
                    
                    crypto - oblivious
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="5.5.2" data-path="./">
            
                <a href="./">
            
                    
                    crypto - secure_hash_v2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.5.3" data-path="../../rev/flagmaker/">
            
                <a href="../../rev/flagmaker/">
            
                    
                    rev - flagmaker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.6" >
            
                <span>
            
                    
                    Teaser Dragon
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.6.1" data-path="../../../TeaserDragon/rev/Chains of trust/">
            
                <a href="../../../TeaserDragon/rev/Chains of trust/">
            
                    
                    rev - Chains of trust
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.7" >
            
                <span>
            
                    
                    Defcamp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.7.1" data-path="../../../defcamp/rev/validator/">
            
                <a href="../../../defcamp/rev/validator/">
            
                    
                    rev - validator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7.2" data-path="../../../defcamp/rev/memsome/">
            
                <a href="../../../defcamp/rev/memsome/">
            
                    
                    rev - memsome
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7.3" data-path="../../../defcamp/web/secops/">
            
                <a href="../../../defcamp/web/secops/">
            
                    
                    web - secops
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7.4" data-path="../../../defcamp/web/chat/">
            
                <a href="../../../defcamp/web/chat/">
            
                    
                    web - chat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7.5" data-path="../../../defcamp/misc/voices/">
            
                <a href="../../../defcamp/misc/voices/">
            
                    
                    misc - voices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.8" >
            
                <span>
            
                    
                    HackIT
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.8.1" data-path="../../../HackIT/coffee_overflow/">
            
                <a href="../../../HackIT/coffee_overflow/">
            
                    
                    rev - coffee_overflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">My Tasks</li>
        
        
    

    
        
        <li class="header">2018</li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <span>
            
                    
                    AIS3 Final
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../../../../../tasks/2018/ais3Final/crypto/100-mama/">
            
                <a href="../../../../../tasks/2018/ais3Final/crypto/100-mama/">
            
                    
                    crypto - mama
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/">
            
                <a href="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/">
            
                    
                    crypto - secureSub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/">
            
                <a href="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/">
            
                    
                    crypto - xorlnarmoni'akda
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4" data-path="../../../../../tasks/2018/ais3Final/rev/100-SecDES/">
            
                <a href="../../../../../tasks/2018/ais3Final/rev/100-SecDES/">
            
                    
                    rev - SecDES
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.5" data-path="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/">
            
                <a href="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/">
            
                    
                    rev - Almighty Duct Tape
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">2019</li>
        
        
    
        <li class="chapter " data-level="8.1" >
            
                <span>
            
                    
                    Balsn CTF
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="../../../../../tasks/2019/BalsnCTF/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="../../../../../tasks/2019/BalsnCTF/crypto/collision/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/crypto/collision/">
            
                    
                    crypto - collision
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.3" data-path="../../../../../tasks/2019/BalsnCTF/crypto/harc4/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/crypto/harc4/">
            
                    
                    crypto - harc4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.4" data-path="../../../../../tasks/2019/BalsnCTF/crypto/unpredictable/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/crypto/unpredictable/">
            
                    
                    crypto - unpredictable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.5" data-path="../../../../../tasks/2019/BalsnCTF/pwn/securenote/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/pwn/securenote/">
            
                    
                    crypwn - securenote
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.6" data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv1/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv1/">
            
                    
                    misc - pyshv1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.7" data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv2/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv2/">
            
                    
                    misc - pyshv2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.8" data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv3/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv3/">
            
                    
                    misc - pyshv3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.9" data-path="../../../../../tasks/2019/BalsnCTF/misc/john/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/misc/john/">
            
                    
                    misc - john
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.10" data-path="../../../../../tasks/2019/BalsnCTF/rev/plam/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/rev/plam/">
            
                    
                    rev - plam
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.11" data-path="../../../../../tasks/2019/BalsnCTF/rev/vim/">
            
                <a href="../../../../../tasks/2019/BalsnCTF/rev/vim/">
            
                    
                    rev - vim
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">2020</li>
        
        
    
        <li class="chapter " data-level="9.1" >
            
                <span>
            
                    
                    Balsn CTF
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="../../../../../tasks/2020/BalsnCTF/crypto/aeshash/">
            
                <a href="../../../../../tasks/2020/BalsnCTF/crypto/aeshash/">
            
                    
                    crypto - aeshash
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">2021</li>
        
        
    
        <li class="chapter " data-level="10.1" >
            
                <span>
            
                    
                    ACSC
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1.1" data-path="../../../../../tasks/2021/ACSC/crypto/share_the_flag/">
            
                <a href="../../../../../tasks/2021/ACSC/crypto/share_the_flag/">
            
                    
                    crypto - Share The Flag
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10.2" >
            
                <span>
            
                    
                    Balsn CTF
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.2.1" data-path="../../../../../tasks/2021/BalsnCTF/">
            
                <a href="../../../../../tasks/2021/BalsnCTF/">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2.2" data-path="../../../../../tasks/2021/BalsnCTF/crypto/1337pins/">
            
                <a href="../../../../../tasks/2021/BalsnCTF/crypto/1337pins/">
            
                    
                    crypto - 1337 pins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2.3" data-path="../../../../../tasks/2021/BalsnCTF/crypto/dlog/">
            
                <a href="../../../../../tasks/2021/BalsnCTF/crypto/dlog/">
            
                    
                    crypto - dlog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2.4" data-path="../../../../../tasks/2021/BalsnCTF/crypto/trinity/">
            
                <a href="../../../../../tasks/2021/BalsnCTF/crypto/trinity/">
            
                    
                    crypto - trinity
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../../.." >crypto - secure_hash_v2</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <div class="wpHeaderContainer">
                    <h1 id="securehash-v2">secure_hash v2</h1>
                    <div>
                        <span><a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/crypto/secure_hash_v2" target="_blank"><img src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github" alt="Attachments"></a></span><span><img src="https://img.shields.io/badge/crypto-488-green.svg?style=for-the-badge&amp;maxAge=3600" alt="crypto - 488"></span><span><img src="https://img.shields.io/badge/solves-10-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600" alt="10 solves"></span></div>
                </div><p></p>
<blockquote>
<p>It has come to our attention that the released version of our
SecureHash class was in fact not completely secure.
We&apos;re deeply sorry about that,
and after whipping our sole developer an appropriate number of
times we now proudly present SecureHash v2.
It features twice as much security as before,
and is now certified to be absolutely free of bugs.</p>
<p>Update: the binary was compiled with g++ and libstdc++, 64bit</p>
</blockquote>
<h2 id="time">Time</h2>
<p>1 hour</p>
<h1 id="solution">Solution</h1>
<h2 id="tldr">TL;DR</h2>
<ol>
<li>Calculate the bucket number of <root, pwd=""></root,></li>
<li>Search 1000 credentials has same bucket number and register them.</li>
<li>Login with <root, pwd=""></root,></li>
</ol>
<p>The task has two operation, register and login.
It store the credential using:</p>
<pre class="language-"><code>sha512(sha512(name) + password)
</code></pre><p>As far as I know, no collision attack is available on this kind of digest method.
But the server has some interesting code when it search for hash:</p>
<pre class="language-"><code class="lang-C++">auth_result <span class="token function">lookup_keyvalue</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> name<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>string digest <span class="token operator">=</span> <span class="token function">sha512sum</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    size_t bucket <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">bucket</span><span class="token punctuation">(</span>digest<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">auto</span> it <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>bucket<span class="token punctuation">)</span><span class="token punctuation">,</span> end <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>bucket<span class="token punctuation">)</span><span class="token punctuation">;</span>
    size_t iterations <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    size_t MAX_ITERATIONS <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token operator">++</span> <span class="token operator">==</span> digest<span class="token punctuation">)</span>
            <span class="token keyword">return</span> AUTH_SUCCESS<span class="token punctuation">;</span> <span class="token comment">// 1</span>

        <span class="token comment">// Avoid DoS attacks by fixing upper time limit.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>iterations<span class="token operator">++</span> <span class="token operator">&gt;=</span> MAX_ITERATIONS<span class="token punctuation">)</span>
            <span class="token keyword">return</span> AUTH_TIMEOUT<span class="token punctuation">;</span> <span class="token comment">// 2</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> AUTH_FAILURE<span class="token punctuation">;</span> <span class="token comment">// 0</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">lookup_keyvalue</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// login successfully, check root and print flag</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>We can login when it reach the limit of iterations,
Search for 1000 credentials with same bucket number as <code>root, pwd</code>,
register them and login with <code>root, pwd</code> to get the flag.
Here&apos;s the <a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/crypto/secure_hash_v2/_files/dos.cpp" target="_blank">code</a>.</p>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="../oblivious/" class="navigation navigation-prev " aria-label="Previous page: crypto - oblivious">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../../rev/flagmaker/" class="navigation navigation-next " aria-label="Next page: rev - flagmaker">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"name":"secure_hash v2","category":"crypto","points":488,"solves":10,"title":"crypto - secure_hash_v2","level":"5.5.2","depth":2,"next":{"title":"rev - flagmaker","level":"5.5.3","depth":2,"path":"writeup/2018/HackOver/rev/flagmaker/README.md","ref":"writeup/2018/HackOver/rev/flagmaker/README.md","articles":[]},"previous":{"title":"crypto - oblivious","level":"5.5.1","depth":2,"path":"writeup/2018/HackOver/crypto/oblivious/README.md","ref":"writeup/2018/HackOver/crypto/oblivious/README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-tomorrow.css"],"lang":{"C":"c","C++":"cpp","asm":"nasm"}},"disqus":{"useIdentifier":false,"shortName":"sasdfwriteup"},"search":{"maxIndexSize":1000000},"html-minifier":{"customAttrSurround":[],"removeScriptTypeAttributes":false,"removeEmptyAttributes":false,"removeRedundantAttributes":false,"removeEmptyElements":false,"sortClassName":true,"caseSensitive":true,"html5":true,"collapseWhitespace":true,"processConditionalComments":false,"quoteCharacter":null,"keepClosingSlash":true,"preventAttributesEscaping":false,"minifyURLs":false,"removeAttributeQuotes":false,"decodeEntities":false,"trimCustomFragments":false,"customAttrAssign":[],"includeAutoGeneratedTags":true,"collapseInlineTagWhitespace":false,"collapseBooleanAttributes":true,"minifyJS":true,"removeTagWhitespace":true,"preserveLineBreaks":false,"sortAttributes":true,"removeStyleLinkTypeAttributes":false,"removeComments":true,"minifyCSS":true,"processScripts":[],"conservativeCollapse":false,"removeOptionalTags":false,"useShortDoctype":false},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"writeup-utils":{"filePrefix":"https://github.com/sasdf/ctf/blob/master","repoPrefix":"https://github.com/sasdf/ctf/blob/master","rawPrefix":"https://raw.githubusercontent.com/sasdf/ctf/master"}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"writeup/2018/HackOver/crypto/secure_hash_v2/README.md","mtime":"2021-11-23T11:07:12.591Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-11-25T02:42:39.634Z"},"basePath":"../../../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../../../gitbook/gitbook.js"></script>
    <script src="../../../../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-search/lunr.min.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>

