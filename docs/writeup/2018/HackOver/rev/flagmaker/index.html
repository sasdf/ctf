<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>rev - flagmaker Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="../../crypto/secure_hash_v2/"rel="prev"/></head><body><div class="book"><div class="book-summary"><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2020</li><li class="chapter"data-level="3.1"><span>TWCTF</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../../2020/tokyoWesterns/rev/metal/"><a href="../../../../2020/tokyoWesterns/rev/metal/">rev - metal</a></li><li class="chapter"data-level="3.1.2"data-path="../../../../2020/tokyoWesterns/crypto/xs/"><a href="../../../../2020/tokyoWesterns/crypto/xs/">crypto - XOR and shift encryptor</a></li></ul></li><li class="chapter"data-level="3.2"><span>Google</span><ul class="articles"><li class="chapter"data-level="3.2.1"data-path="../../../../2020/google/crypto/oracle/"><a href="../../../../2020/google/crypto/oracle/">crypto - Oracle</a></li><li class="chapter"data-level="3.2.2"data-path="../../../../2020/google/crypto/yafm/"><a href="../../../../2020/google/crypto/yafm/">crypto - YAFM</a></li><li class="chapter"data-level="3.2.3"data-path="../../../../2020/google/crypto/quantum/"><a href="../../../../2020/google/crypto/quantum/">crypto - Quantum Pyramids</a></li><li class="chapter"data-level="3.2.4"data-path="../../../../2020/google/crypto/sharky/"><a href="../../../../2020/google/crypto/sharky/">crypto - SHArky</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="4.1"><span>Google</span><ul class="articles"><li class="chapter"data-level="4.1.1"data-path="../../../../2019/google/crypto/reality/"><a href="../../../../2019/google/crypto/reality/">crypto - reality</a></li><li class="chapter"data-level="4.1.2"data-path="../../../../2019/google/crypto/qkd/"><a href="../../../../2019/google/crypto/qkd/">crypto - Quantum Key Distribution</a></li><li class="chapter"data-level="4.1.3"data-path="../../../../2019/google/crypto/cell/"><a href="../../../../2019/google/crypto/cell/">crypto - Reverse a cellular automata</a></li><li class="chapter"data-level="4.1.4"data-path="../../../../2019/google/hardware/flagrom/"><a href="../../../../2019/google/hardware/flagrom/">hardware - flagrom</a></li><li class="chapter"data-level="4.1.5"data-path="../../../../2019/google/hardware/minetest/"><a href="../../../../2019/google/hardware/minetest/">hardware - minetest</a></li><li class="chapter"data-level="4.1.6"data-path="../../../../2019/google/hardware/remote/"><a href="../../../../2019/google/hardware/remote/">hardware - Remote Control</a></li><li class="chapter"data-level="4.1.7"data-path="../../../../2019/google/web/glotto/"><a href="../../../../2019/google/web/glotto/">web - gLotto</a></li><li class="chapter"data-level="4.1.8"data-path="../../../../2019/google/rev/dial/"><a href="../../../../2019/google/rev/dial/">rev - Dialtone</a></li></ul></li><li class="chapter"data-level="4.2"><span>Plaid</span><ul class="articles"><li class="chapter"data-level="4.2.1"data-path="../../../../2019/plaid/crypto/cypress/"><a href="../../../../2019/plaid/crypto/cypress/">crypto - SPlaid Cypress</a></li><li class="chapter"data-level="4.2.2"data-path="../../../../2019/plaid/rev/bigmaffs/"><a href="../../../../2019/plaid/rev/bigmaffs/">rev - big maffs</a></li></ul></li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>hxp</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../../../hxp/crypto/blinder_v2/"><a href="../../../hxp/crypto/blinder_v2/">crypto - blinder_v2</a></li><li class="chapter"data-level="5.1.2"data-path="../../../hxp/crypto/blinder/"><a href="../../../hxp/crypto/blinder/">crypto - blinder</a></li><li class="chapter"data-level="5.1.3"data-path="../../../hxp/crypto/curve/"><a href="../../../hxp/crypto/curve/">crypto - curve12833227</a></li><li class="chapter"data-level="5.1.4"data-path="../../../hxp/crypto/oops/"><a href="../../../hxp/crypto/oops/">crypto - oops2</a></li><li class="chapter"data-level="5.1.5"data-path="../../../hxp/crypto/blind/"><a href="../../../hxp/crypto/blind/">crypto - blind</a></li></ul></li><li class="chapter"data-level="5.2"><span>Pwn2Win</span><ul class="articles"><li class="chapter"data-level="5.2.1"data-path="../../../pwn2win/rev/back_to_bletchley_park/"><a href="../../../pwn2win/rev/back_to_bletchley_park/">cryrev - Back To Bletchley Park</a></li><li class="chapter"data-level="5.2.2"data-path="../../../pwn2win/crypto/GCM/"><a href="../../../pwn2win/crypto/GCM/">crypto - GCM</a></li></ul></li><li class="chapter"data-level="5.3"><span>HITCON</span><ul class="articles"><li class="chapter"data-level="5.3.1"data-path="../../../hitcon/crypto/lostmod/"><a href="../../../hitcon/crypto/lostmod/">crypto - Lost Modulus</a></li><li class="chapter"data-level="5.3.2"data-path="../../../hitcon/crypto/secret/"><a href="../../../hitcon/crypto/secret/">crypwn - Secret Note</a></li></ul></li><li class="chapter"data-level="5.4"><span>Hack.lu</span><ul class="articles"><li class="chapter"data-level="5.4.1"data-path="../../../Hack.lu/crypto/escape/"><a href="../../../Hack.lu/crypto/escape/">crypto - Escape the Grid</a></li><li class="chapter"data-level="5.4.2"data-path="../../../Hack.lu/crypto/relation/"><a href="../../../Hack.lu/crypto/relation/">crypto - Relations</a></li><li class="chapter"data-level="5.4.3"data-path="../../../Hack.lu/crypto/lfsr/"><a href="../../../Hack.lu/crypto/lfsr/">crypto - LFSR StreamCipher</a><ul class="articles"><li class="chapter"data-level="5.4.3.1"data-path="../../../Hack.lu/crypto/lfsr/task.html"><a href="../../../Hack.lu/crypto/lfsr/task.html">task description</a></li></ul></li></ul></li><li class="chapter"data-level="5.5"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="5.5.1"data-path="../../crypto/oblivious/"><a href="../../crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="5.5.2"data-path="../../crypto/secure_hash_v2/"><a href="../../crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter active"data-level="5.5.3"data-path="./"><a href="./">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="5.6"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="5.6.1"data-path="../../../TeaserDragon/rev/Chains of trust/"><a href="../../../TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="5.7"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="5.7.1"data-path="../../../defcamp/rev/validator/"><a href="../../../defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="5.7.2"data-path="../../../defcamp/rev/memsome/"><a href="../../../defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="5.7.3"data-path="../../../defcamp/web/secops/"><a href="../../../defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="5.7.4"data-path="../../../defcamp/web/chat/"><a href="../../../defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="5.7.5"data-path="../../../defcamp/misc/voices/"><a href="../../../defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="5.8"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="5.8.1"data-path="../../../HackIT/coffee_overflow/"><a href="../../../HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="7.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="7.1.1"data-path="../../../../../tasks/2018/ais3Final/crypto/100-mama/"><a href="../../../../../tasks/2018/ais3Final/crypto/100-mama/">crypto - mama</a></li><li class="chapter"data-level="7.1.2"data-path="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/"><a href="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/">crypto - secureSub</a></li><li class="chapter"data-level="7.1.3"data-path="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/"><a href="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/">crypto - xorlnarmoni'akda</a></li><li class="chapter"data-level="7.1.4"data-path="../../../../../tasks/2018/ais3Final/rev/100-SecDES/"><a href="../../../../../tasks/2018/ais3Final/rev/100-SecDES/">rev - SecDES</a></li><li class="chapter"data-level="7.1.5"data-path="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/"><a href="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="8.1"><span>Balsn CTF</span><ul class="articles"><li class="chapter"data-level="8.1.1"data-path="../../../../../tasks/2019/BalsnCTF/"><a href="../../../../../tasks/2019/BalsnCTF/">Overview</a></li><li class="chapter"data-level="8.1.2"data-path="../../../../../tasks/2019/BalsnCTF/crypto/collision/"><a href="../../../../../tasks/2019/BalsnCTF/crypto/collision/">crypto - collision</a></li><li class="chapter"data-level="8.1.3"data-path="../../../../../tasks/2019/BalsnCTF/crypto/harc4/"><a href="../../../../../tasks/2019/BalsnCTF/crypto/harc4/">crypto - harc4</a></li><li class="chapter"data-level="8.1.4"data-path="../../../../../tasks/2019/BalsnCTF/crypto/unpredictable/"><a href="../../../../../tasks/2019/BalsnCTF/crypto/unpredictable/">crypto - unpredictable</a></li><li class="chapter"data-level="8.1.5"data-path="../../../../../tasks/2019/BalsnCTF/pwn/securenote/"><a href="../../../../../tasks/2019/BalsnCTF/pwn/securenote/">crypwn - securenote</a></li><li class="chapter"data-level="8.1.6"data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv1/"><a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv1/">misc - pyshv1</a></li><li class="chapter"data-level="8.1.7"data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv2/"><a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv2/">misc - pyshv2</a></li><li class="chapter"data-level="8.1.8"data-path="../../../../../tasks/2019/BalsnCTF/misc/pyshv3/"><a href="../../../../../tasks/2019/BalsnCTF/misc/pyshv3/">misc - pyshv3</a></li><li class="chapter"data-level="8.1.9"data-path="../../../../../tasks/2019/BalsnCTF/misc/john/"><a href="../../../../../tasks/2019/BalsnCTF/misc/john/">misc - john</a></li><li class="chapter"data-level="8.1.10"data-path="../../../../../tasks/2019/BalsnCTF/rev/plam/"><a href="../../../../../tasks/2019/BalsnCTF/rev/plam/">rev - plam</a></li><li class="chapter"data-level="8.1.11"data-path="../../../../../tasks/2019/BalsnCTF/rev/vim/"><a href="../../../../../tasks/2019/BalsnCTF/rev/vim/">rev - vim</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"target="blank"class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">rev - flagmaker</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="flagmaker">flagmaker</h1><div><span><a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/rev/flagmaker"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="rev - 500"src="https://img.shields.io/badge/rev-500-green.svg?style=for-the-badge&amp;maxAge=3600"></span><span><img alt="2 solves"src="https://img.shields.io/badge/solves-2-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><p></p><blockquote><p>Solving CTF challenges often involves a lot of work, which is very unfair to lazy competitors. To even things out, we designed a self-solving challenge: Just type make flag and make yourself a coffee while the solution is computed.</p></blockquote><h1 id="time">Time</h1><p>6 hours<br>Mostly for solving the turing machine rather than reversing.</p><h1 id="solution">Solution</h1><h2 id="tldr">TL;DR</h2><ol><li>Extract the turing machine configuration from the code.</li><li>Observe the behavior of it.</li><li>Implement a efficient version.</li></ol><p>The task gives a Makefile which contains a lot of long function. Here&apos;s a slightly a <a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/rev/flagmaker/_files/Makefile"target="_blank">beautified version</a>. One of our team member (@Bookgin) tells me that we can use</p><pre class="language-"><code>$(if $(shell echo $(3) 1&gt;&amp;2),,)
</code></pre><p>to inspect variables.</p><p>That Makefile code is not very readable, so I <a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/rev/flagmaker/_files/rev0.py"target="_blank">reimplement</a> each function using python. And here&apos;s a <a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/rev/flagmaker/_files/rev.py"target="_blank">better version</a> after cleanup. (Note: we use <code>x</code> to represent <code>+</code> and <code>.</code> to represent <code>-</code> for better visualization effect)</p><p>The code is actually simulating a turing machine, and it use the content on the tape when it halt to calculate the flag. The state graph looks like:</p><pre class="language-"><code>              .-.
              \ V
           .-&gt; G -&gt; (Terminate)
          /
     .-&gt; C ---.
    /          v
-&gt; A &lt;=&gt; B --&gt; D &lt;.
   ^     ^    / \_/
   |     |   /
   F &lt;=&gt; E &lt;&apos;
</code></pre><p>If you run the cleanup-ed script, You can see some pattern like this</p><pre class="language-"><code>          Notice this line ---.
                              V
 977 D ........xx.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 978 D .........x.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 979 E .......x.x.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 980 F ......xx.x.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 981 E ......xx.x.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 982 F ......xxxx.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 983 E ......xxxx.x.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 984 F ......xxxxxx.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 985 E ......xxxxxx.x.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 986 F ......xxxxxxxx.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 987 E ......xxxxxxxx.x.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 988 F ......xxxxxxxxxx.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 989 E ......xxxxxxxxxx.x.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 990 F ......xxxxxxxxxxxx.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 991 E ......xxxxxxxxxxxx.x.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 992 F ......xxxxxxxxxxxxxx.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 993 E ......xxxxxxxxxxxxxx.x...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 994 F ......xxxxxxxxxxxxxxxx...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 995 E ......xxxxxxxxxxxxxxxx...x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 996 F ......xxxxxxxxxxxxxxxxx..x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 997 A ......xxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 998 B ......xxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x.x..x.....
 999 D ......xxxxxxxxxxxxxxxxxxx..x.x.x.x.x.x.x.x.x.x.x.x..x.....
1000 E ......xxxxxxxxxxxxxxxxxxx.xx.x.x.x.x.x.x.x.x.x.x.x..x.....
1001 F ......xxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x..x.....
1002 E ......xxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x..x.....
1003 B ......xxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x..x.....
1004 D ......xxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x.x.x.x.x.x.x..x.....
1005 D ......xxxxxxxxxxxxxxxxxxxx...x.x.x.x.x.x.x.x.x.x.x..x.....
1006 E ......xxxxxxxxxxxxxxxxxxxxx..x.x.x.x.x.x.x.x.x.x.x..x.....
1007 B ......xxxxxxxxxxxxxxxxxxxxx..x.x.x.x.x.x.x.x.x.x.x..x.....
1008 D ......xxxxxxxxxxxxxxxxxx.xx..x.x.x.x.x.x.x.x.x.x.x..x.....
1009 D ......xxxxxxxxxxxxxxxxxx..x..x.x.x.x.x.x.x.x.x.x.x..x.....
1010 E ......xxxxxxxxxxxxxxxxxxx.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1011 B ......xxxxxxxxxxxxxxxxxxx.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1012 D ......xxxxxxxxxxxxxxxx.xx.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1013 D ......xxxxxxxxxxxxxxxx..x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1014 E ......xxxxxxxxxxxxxxxxx.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1015 B ......xxxxxxxxxxxxxxxxx.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1016 D ......xxxxxxxxxxxxxx.xx.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1017 D ......xxxxxxxxxxxxxx..x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1018 E ......xxxxxxxxxxxxxxx.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1019 B ......xxxxxxxxxxxxxxx.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1020 D ......xxxxxxxxxxxx.xx.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1021 D ......xxxxxxxxxxxx..x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1022 E ......xxxxxxxxxxxxx.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1023 B ......xxxxxxxxxxxxx.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1024 D ......xxxxxxxxxx.xx.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1025 D ......xxxxxxxxxx..x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1026 E ......xxxxxxxxxxx.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1027 B ......xxxxxxxxxxx.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1028 D ......xxxxxxxx.xx.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1029 D ......xxxxxxxx..x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1030 E ......xxxxxxxxx.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1031 B ......xxxxxxxxx.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1032 D ......xxxxxx.xx.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1033 D ......xxxxxx..x.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1034 E ......xxxxxxx.x.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1035 B ......xxxxxxx.x.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1036 D ......xxxx.xx.x.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
1037 D ......xxxx..x.x.x.x.x.x.x.x..x.x.x.x.x.x.x.x.x.x.x..x.....
</code></pre><p>It keeps pushing waves from left to right. <code>EF</code> loop will change alternating sequence <code>.x</code> into all <code>xx</code>, and state <code>E</code> will detect consecutive <code>..</code>, and push it to the right. <code>BDDE</code> loop will change <code>xx</code> prefix back to <code>.x</code> sequence.</p><p>When it reach the left boundary, it will add a new symbol, like this:</p><pre class="language-"><code> 601 B .....xxxxxxxxxxxxxxxxx.x.x.x.x...x..x........
 602 D .....xxxxxxxxxxxxxx.xx.x.x.x.x...x..x........
 603 D .....xxxxxxxxxxxxxx..x.x.x.x.x...x..x........
 604 E .....xxxxxxxxxxxxxxx.x.x.x.x.x...x..x........
 605 B .....xxxxxxxxxxxxxxx.x.x.x.x.x...x..x........
 606 D .....xxxxxxxxxxxx.xx.x.x.x.x.x...x..x........
 607 D .....xxxxxxxxxxxx..x.x.x.x.x.x...x..x........
 608 E .....xxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
 609 B .....xxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
 610 D .....xxxxxxxxxx.xx.x.x.x.x.x.x...x..x........
 611 D .....xxxxxxxxxx..x.x.x.x.x.x.x...x..x........
 612 E .....xxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 613 B .....xxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 614 D .....xxxxxxxx.xx.x.x.x.x.x.x.x...x..x........
 615 D .....xxxxxxxx..x.x.x.x.x.x.x.x...x..x........
 616 E .....xxxxxxxxx.x.x.x.x.x.x.x.x...x..x........
 617 B .....xxxxxxxxx.x.x.x.x.x.x.x.x...x..x........
 618 D .....xxxxxx.xx.x.x.x.x.x.x.x.x...x..x........
 619 D .....xxxxxx..x.x.x.x.x.x.x.x.x...x..x........
 620 E .....xxxxxxx.x.x.x.x.x.x.x.x.x...x..x........
 621 B .....xxxxxxx.x.x.x.x.x.x.x.x.x...x..x........
 622 D .....xxxx.xx.x.x.x.x.x.x.x.x.x...x..x........
 623 D .....xxxx..x.x.x.x.x.x.x.x.x.x...x..x........
 624 E .....xxxxx.x.x.x.x.x.x.x.x.x.x...x..x........
 625 B .....xxxxx.x.x.x.x.x.x.x.x.x.x...x..x........
 626 D .....xx.xx.x.x.x.x.x.x.x.x.x.x...x..x........
 627 D .....xx..x.x.x.x.x.x.x.x.x.x.x...x..x........
 628 E .....xxx.x.x.x.x.x.x.x.x.x.x.x...x..x........
 629 B .....xxx.x.x.x.x.x.x.x.x.x.x.x...x..x........
 630 D ......xx.x.x.x.x.x.x.x.x.x.x.x...x..x........
 631 D .......x.x.x.x.x.x.x.x.x.x.x.x...x..x........
 632 E .....x.x.x.x.x.x.x.x.x.x.x.x.x...x..x........
 633 F ....xx.x.x.x.x.x.x.x.x.x.x.x.x...x..x........
 634 E ....xx.x.x.x.x.x.x.x.x.x.x.x.x...x..x........
 635 F ....xxxx.x.x.x.x.x.x.x.x.x.x.x...x..x........
 636 E ....xxxx.x.x.x.x.x.x.x.x.x.x.x...x..x........
 637 F ....xxxxxx.x.x.x.x.x.x.x.x.x.x...x..x........
 638 E ....xxxxxx.x.x.x.x.x.x.x.x.x.x...x..x........
 639 F ....xxxxxxxx.x.x.x.x.x.x.x.x.x...x..x........
 640 E ....xxxxxxxx.x.x.x.x.x.x.x.x.x...x..x........
 641 F ....xxxxxxxxxx.x.x.x.x.x.x.x.x...x..x........
 642 E ....xxxxxxxxxx.x.x.x.x.x.x.x.x...x..x........
 643 F ....xxxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 644 E ....xxxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 645 F ....xxxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
 646 E ....xxxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
</code></pre><p>When those two lines collapsed, the behavior depends on the pattern at the end.</p><p>Here&apos;s an example.</p><pre class="language-"><code> 642 E ....xxxxxxxxxx.x.x.x.x.x.x.x.x...x..x........
 643 F ....xxxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 644 E ....xxxxxxxxxxxx.x.x.x.x.x.x.x...x..x........
 645 F ....xxxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
 646 E ....xxxxxxxxxxxxxx.x.x.x.x.x.x...x..x........
 647 F ....xxxxxxxxxxxxxxxx.x.x.x.x.x...x..x........
 648 E ....xxxxxxxxxxxxxxxx.x.x.x.x.x...x..x........
 649 F ....xxxxxxxxxxxxxxxxxx.x.x.x.x...x..x........
 650 E ....xxxxxxxxxxxxxxxxxx.x.x.x.x...x..x........
 651 F ....xxxxxxxxxxxxxxxxxxxx.x.x.x...x..x........
 652 E ....xxxxxxxxxxxxxxxxxxxx.x.x.x...x..x........
 653 F ....xxxxxxxxxxxxxxxxxxxxxx.x.x...x..x........
 654 E ....xxxxxxxxxxxxxxxxxxxxxx.x.x...x..x........
 655 F ....xxxxxxxxxxxxxxxxxxxxxxxx.x...x..x........
 656 E ....xxxxxxxxxxxxxxxxxxxxxxxx.x...x..x........
 657 F ....xxxxxxxxxxxxxxxxxxxxxxxxxx...x..x........
 658 E ....xxxxxxxxxxxxxxxxxxxxxxxxxx...x..x........
 659 F ....xxxxxxxxxxxxxxxxxxxxxxxxxxx..x..x........
 660 A ....xxxxxxxxxxxxxxxxxxxxxxxxxxxx.x..x........
 661 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x........
 662 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxx...x........
 663 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x........
 664 F ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x........
 665 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x........
 666 F ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx........
 667 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx........
 668 F ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.......
 669 A ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx......
 670 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.....
 671 A ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.....
 672 C ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx......
 673 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x....
 674 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx...
 675 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx...
 676 A ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx...
 677 C ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..xx...
 678 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xxx...
 679 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x...
 680 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...x...
 681 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x...
 682 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x...
 683 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx..x...
 684 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x..x...
 685 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x..x...
 686 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x..x...
 687 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx.x..x...
 688 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x.x..x...
 689 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x..x...
 690 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x..x...
 691 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxx.xx.x.x..x...
 692 D ....xxxxxxxxxxxxxxxxxxxxxxxxxxxx..x.x.x..x...
 693 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x..x...
 694 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x..x...
 695 D ....xxxxxxxxxxxxxxxxxxxxxxxxxx.xx.x.x.x..x...
 696 D ....xxxxxxxxxxxxxxxxxxxxxxxxxx..x.x.x.x..x...
 697 E ....xxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x..x...
 698 B ....xxxxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x..x...
 699 D ....xxxxxxxxxxxxxxxxxxxxxxxx.xx.x.x.x.x..x...
 700 D ....xxxxxxxxxxxxxxxxxxxxxxxx..x.x.x.x.x..x...
 701 E ....xxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x..x...
 702 B ....xxxxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x..x...
 703 D ....xxxxxxxxxxxxxxxxxxxxxx.xx.x.x.x.x.x..x...
 704 D ....xxxxxxxxxxxxxxxxxxxxxx..x.x.x.x.x.x..x...
 705 E ....xxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x..x...
 706 B ....xxxxxxxxxxxxxxxxxxxxxxx.x.x.x.x.x.x..x...
 707 D ....xxxxxxxxxxxxxxxxxxxx.xx.x.x.x.x.x.x..x...
 708 D ....xxxxxxxxxxxxxxxxxxxx..x.x.x.x.x.x.x..x...
</code></pre><p>Each push has complexity O(n^2), where n is current size of tape. The size grows exponentially with complexity O((5/4)^t). It will take too much time and space to simulate it. What we need is to store current length, then we can calculate the length and position when the wave arrive left boundary using:</p><pre class="language-"><code>pos = -(length % 4)
length += length // 4
</code></pre><p>The behavior when two lines collapse doesn&apos;t depends on the length but the pattern. So we can simulate the behavior with only 12 <code>x</code> in the middle, get the difference of length, and add the difference back to current length.</p><p>Here&apos;s the <a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/HackOver/rev/flagmaker/_files/solve.py"target="_blank">solver</a>, the turing machine ends with length <code>2537699363594175843066</code> and has <code>2537699363594175843064</code> <code>x</code> symbols on the tape.</p><h1 id="additional-notes">Additional Notes</h1><p>Admin says that the turing machine is Busy Beaver on <a href="https://web.archive.org/web/20140717022943/http://www.drb.insel.de/~heiner/BB/macro.html"target="_blank">this page</a>.</p><p>And here&apos;s the <a href="https://gist.github.com/lava/34ff5a1fa28503904aff0e147cebf566"target="_blank">un-obfuscated code</a> from admin.</p></section></div></div></div><a href="../../crypto/secure_hash_v2/"class="navigation navigation-prev navigation-unique"aria-label="Previous page: crypto - secure_hash_v2"><i class="fa fa-angle-left"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"flagmaker",category:"rev",points:500,solves:2,title:"rev - flagmaker",level:"5.5.3",depth:2,next:{title:"Teaser Dragon",level:"5.6",depth:1,ref:"",articles:[{title:"rev - Chains of trust",level:"5.6.1",depth:2,path:"writeup/2018/TeaserDragon/rev/Chains of trust/README.md",ref:"writeup/2018/TeaserDragon/rev/Chains of trust/README.md",articles:[]}]},previous:{title:"crypto - secure_hash_v2",level:"5.5.2",depth:2,path:"writeup/2018/HackOver/crypto/secure_hash_v2/README.md",ref:"writeup/2018/HackOver/crypto/secure_hash_v2/README.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{maxIndexSize:1e6},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf/blob/master",repoPrefix:"https://github.com/sasdf/ctf/blob/master",rawPrefix:"https://raw.githubusercontent.com/sasdf/ctf/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"writeup/2018/HackOver/rev/flagmaker/README.md",mtime:"2020-08-30T20:59:08.301Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2020-09-25T17:26:22.339Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script></body></html>