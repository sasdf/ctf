<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>crypto - 1337 pins Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="../dlog/"rel="next"/><link href="../../"rel="prev"/></head><body><div class="book"><div class="book-summary"><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2020</li><li class="chapter"data-level="3.1"><span>TWCTF</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../../../writeup/2020/tokyoWesterns/rev/metal/"><a href="../../../../../writeup/2020/tokyoWesterns/rev/metal/">rev - metal</a></li><li class="chapter"data-level="3.1.2"data-path="../../../../../writeup/2020/tokyoWesterns/crypto/xs/"><a href="../../../../../writeup/2020/tokyoWesterns/crypto/xs/">crypto - XOR and shift encryptor</a></li></ul></li><li class="chapter"data-level="3.2"><span>Google</span><ul class="articles"><li class="chapter"data-level="3.2.1"data-path="../../../../../writeup/2020/google/crypto/oracle/"><a href="../../../../../writeup/2020/google/crypto/oracle/">crypto - Oracle</a></li><li class="chapter"data-level="3.2.2"data-path="../../../../../writeup/2020/google/crypto/yafm/"><a href="../../../../../writeup/2020/google/crypto/yafm/">crypto - YAFM</a></li><li class="chapter"data-level="3.2.3"data-path="../../../../../writeup/2020/google/crypto/quantum/"><a href="../../../../../writeup/2020/google/crypto/quantum/">crypto - Quantum Pyramids</a></li><li class="chapter"data-level="3.2.4"data-path="../../../../../writeup/2020/google/crypto/sharky/"><a href="../../../../../writeup/2020/google/crypto/sharky/">crypto - SHArky</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="4.1"><span>Google</span><ul class="articles"><li class="chapter"data-level="4.1.1"data-path="../../../../../writeup/2019/google/crypto/reality/"><a href="../../../../../writeup/2019/google/crypto/reality/">crypto - reality</a></li><li class="chapter"data-level="4.1.2"data-path="../../../../../writeup/2019/google/crypto/qkd/"><a href="../../../../../writeup/2019/google/crypto/qkd/">crypto - Quantum Key Distribution</a></li><li class="chapter"data-level="4.1.3"data-path="../../../../../writeup/2019/google/crypto/cell/"><a href="../../../../../writeup/2019/google/crypto/cell/">crypto - Reverse a cellular automata</a></li><li class="chapter"data-level="4.1.4"data-path="../../../../../writeup/2019/google/hardware/flagrom/"><a href="../../../../../writeup/2019/google/hardware/flagrom/">hardware - flagrom</a></li><li class="chapter"data-level="4.1.5"data-path="../../../../../writeup/2019/google/hardware/minetest/"><a href="../../../../../writeup/2019/google/hardware/minetest/">hardware - minetest</a></li><li class="chapter"data-level="4.1.6"data-path="../../../../../writeup/2019/google/hardware/remote/"><a href="../../../../../writeup/2019/google/hardware/remote/">hardware - Remote Control</a></li><li class="chapter"data-level="4.1.7"data-path="../../../../../writeup/2019/google/web/glotto/"><a href="../../../../../writeup/2019/google/web/glotto/">web - gLotto</a></li><li class="chapter"data-level="4.1.8"data-path="../../../../../writeup/2019/google/rev/dial/"><a href="../../../../../writeup/2019/google/rev/dial/">rev - Dialtone</a></li></ul></li><li class="chapter"data-level="4.2"><span>Plaid</span><ul class="articles"><li class="chapter"data-level="4.2.1"data-path="../../../../../writeup/2019/plaid/crypto/cypress/"><a href="../../../../../writeup/2019/plaid/crypto/cypress/">crypto - SPlaid Cypress</a></li><li class="chapter"data-level="4.2.2"data-path="../../../../../writeup/2019/plaid/rev/bigmaffs/"><a href="../../../../../writeup/2019/plaid/rev/bigmaffs/">rev - big maffs</a></li></ul></li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>hxp</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../../../../../writeup/2018/hxp/crypto/blinder_v2/"><a href="../../../../../writeup/2018/hxp/crypto/blinder_v2/">crypto - blinder_v2</a></li><li class="chapter"data-level="5.1.2"data-path="../../../../../writeup/2018/hxp/crypto/blinder/"><a href="../../../../../writeup/2018/hxp/crypto/blinder/">crypto - blinder</a></li><li class="chapter"data-level="5.1.3"data-path="../../../../../writeup/2018/hxp/crypto/curve/"><a href="../../../../../writeup/2018/hxp/crypto/curve/">crypto - curve12833227</a></li><li class="chapter"data-level="5.1.4"data-path="../../../../../writeup/2018/hxp/crypto/oops/"><a href="../../../../../writeup/2018/hxp/crypto/oops/">crypto - oops2</a></li><li class="chapter"data-level="5.1.5"data-path="../../../../../writeup/2018/hxp/crypto/blind/"><a href="../../../../../writeup/2018/hxp/crypto/blind/">crypto - blind</a></li></ul></li><li class="chapter"data-level="5.2"><span>Pwn2Win</span><ul class="articles"><li class="chapter"data-level="5.2.1"data-path="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/"><a href="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/">cryrev - Back To Bletchley Park</a></li><li class="chapter"data-level="5.2.2"data-path="../../../../../writeup/2018/pwn2win/crypto/GCM/"><a href="../../../../../writeup/2018/pwn2win/crypto/GCM/">crypto - GCM</a></li></ul></li><li class="chapter"data-level="5.3"><span>HITCON</span><ul class="articles"><li class="chapter"data-level="5.3.1"data-path="../../../../../writeup/2018/hitcon/crypto/lostmod/"><a href="../../../../../writeup/2018/hitcon/crypto/lostmod/">crypto - Lost Modulus</a></li><li class="chapter"data-level="5.3.2"data-path="../../../../../writeup/2018/hitcon/crypto/secret/"><a href="../../../../../writeup/2018/hitcon/crypto/secret/">crypwn - Secret Note</a></li></ul></li><li class="chapter"data-level="5.4"><span>Hack.lu</span><ul class="articles"><li class="chapter"data-level="5.4.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/escape/"><a href="../../../../../writeup/2018/Hack.lu/crypto/escape/">crypto - Escape the Grid</a></li><li class="chapter"data-level="5.4.2"data-path="../../../../../writeup/2018/Hack.lu/crypto/relation/"><a href="../../../../../writeup/2018/Hack.lu/crypto/relation/">crypto - Relations</a></li><li class="chapter"data-level="5.4.3"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/">crypto - LFSR StreamCipher</a><ul class="articles"><li class="chapter"data-level="5.4.3.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html">task description</a></li></ul></li></ul></li><li class="chapter"data-level="5.5"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="5.5.1"data-path="../../../../../writeup/2018/HackOver/crypto/oblivious/"><a href="../../../../../writeup/2018/HackOver/crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="5.5.2"data-path="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/"><a href="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter"data-level="5.5.3"data-path="../../../../../writeup/2018/HackOver/rev/flagmaker/"><a href="../../../../../writeup/2018/HackOver/rev/flagmaker/">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="5.6"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="5.6.1"data-path="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/"><a href="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="5.7"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="5.7.1"data-path="../../../../../writeup/2018/defcamp/rev/validator/"><a href="../../../../../writeup/2018/defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="5.7.2"data-path="../../../../../writeup/2018/defcamp/rev/memsome/"><a href="../../../../../writeup/2018/defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="5.7.3"data-path="../../../../../writeup/2018/defcamp/web/secops/"><a href="../../../../../writeup/2018/defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="5.7.4"data-path="../../../../../writeup/2018/defcamp/web/chat/"><a href="../../../../../writeup/2018/defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="5.7.5"data-path="../../../../../writeup/2018/defcamp/misc/voices/"><a href="../../../../../writeup/2018/defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="5.8"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="5.8.1"data-path="../../../../../writeup/2018/HackIT/coffee_overflow/"><a href="../../../../../writeup/2018/HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="7.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="7.1.1"data-path="../../../../2018/ais3Final/crypto/100-mama/"><a href="../../../../2018/ais3Final/crypto/100-mama/">crypto - mama</a></li><li class="chapter"data-level="7.1.2"data-path="../../../../2018/ais3Final/crypto/200-secureSub/"><a href="../../../../2018/ais3Final/crypto/200-secureSub/">crypto - secureSub</a></li><li class="chapter"data-level="7.1.3"data-path="../../../../2018/ais3Final/crypto/300-xorlnarmoni'akda/"><a href="../../../../2018/ais3Final/crypto/300-xorlnarmoni'akda/">crypto - xorlnarmoni'akda</a></li><li class="chapter"data-level="7.1.4"data-path="../../../../2018/ais3Final/rev/100-SecDES/"><a href="../../../../2018/ais3Final/rev/100-SecDES/">rev - SecDES</a></li><li class="chapter"data-level="7.1.5"data-path="../../../../2018/ais3Final/rev/200-AlmightyDuctTape/"><a href="../../../../2018/ais3Final/rev/200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="8.1"><span>Balsn CTF</span><ul class="articles"><li class="chapter"data-level="8.1.1"data-path="../../../../2019/BalsnCTF/"><a href="../../../../2019/BalsnCTF/">Overview</a></li><li class="chapter"data-level="8.1.2"data-path="../../../../2019/BalsnCTF/crypto/collision/"><a href="../../../../2019/BalsnCTF/crypto/collision/">crypto - collision</a></li><li class="chapter"data-level="8.1.3"data-path="../../../../2019/BalsnCTF/crypto/harc4/"><a href="../../../../2019/BalsnCTF/crypto/harc4/">crypto - harc4</a></li><li class="chapter"data-level="8.1.4"data-path="../../../../2019/BalsnCTF/crypto/unpredictable/"><a href="../../../../2019/BalsnCTF/crypto/unpredictable/">crypto - unpredictable</a></li><li class="chapter"data-level="8.1.5"data-path="../../../../2019/BalsnCTF/pwn/securenote/"><a href="../../../../2019/BalsnCTF/pwn/securenote/">crypwn - securenote</a></li><li class="chapter"data-level="8.1.6"data-path="../../../../2019/BalsnCTF/misc/pyshv1/"><a href="../../../../2019/BalsnCTF/misc/pyshv1/">misc - pyshv1</a></li><li class="chapter"data-level="8.1.7"data-path="../../../../2019/BalsnCTF/misc/pyshv2/"><a href="../../../../2019/BalsnCTF/misc/pyshv2/">misc - pyshv2</a></li><li class="chapter"data-level="8.1.8"data-path="../../../../2019/BalsnCTF/misc/pyshv3/"><a href="../../../../2019/BalsnCTF/misc/pyshv3/">misc - pyshv3</a></li><li class="chapter"data-level="8.1.9"data-path="../../../../2019/BalsnCTF/misc/john/"><a href="../../../../2019/BalsnCTF/misc/john/">misc - john</a></li><li class="chapter"data-level="8.1.10"data-path="../../../../2019/BalsnCTF/rev/plam/"><a href="../../../../2019/BalsnCTF/rev/plam/">rev - plam</a></li><li class="chapter"data-level="8.1.11"data-path="../../../../2019/BalsnCTF/rev/vim/"><a href="../../../../2019/BalsnCTF/rev/vim/">rev - vim</a></li></ul></li><li class="header">2020</li><li class="chapter"data-level="9.1"><span>Balsn CTF</span><ul class="articles"><li class="chapter"data-level="9.1.1"data-path="../../../../2020/BalsnCTF/crypto/aeshash/"><a href="../../../../2020/BalsnCTF/crypto/aeshash/">crypto - aeshash</a></li></ul></li><li class="header">2021</li><li class="chapter"data-level="10.1"><span>ACSC</span><ul class="articles"><li class="chapter"data-level="10.1.1"data-path="../../../ACSC/crypto/share_the_flag/"><a href="../../../ACSC/crypto/share_the_flag/">crypto - Share The Flag</a></li></ul></li><li class="chapter"data-level="10.2"><span>Balsn CTF</span><ul class="articles"><li class="chapter"data-level="10.2.1"data-path="../../"><a href="../../">Overview</a></li><li class="chapter active"data-level="10.2.2"data-path="./"><a href="./">crypto - 1337 pins</a></li><li class="chapter"data-level="10.2.3"data-path="../dlog/"><a href="../dlog/">crypto - dlog</a></li><li class="chapter"data-level="10.2.4"data-path="../trinity/"><a href="../trinity/">crypto - trinity</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"target="blank"class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">crypto - 1337 pins</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="1337-pins">1337 pins</h1><div><span><a href="https://github.com/sasdf/ctf/blob/master/tasks/2021/BalsnCTF/crypto/1337pins"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="crypto - 422"src="https://img.shields.io/badge/crypto-422-green.svg?style=for-the-badge&amp;maxAge=3600"></span><span><img alt="5 solves"src="https://img.shields.io/badge/solves-5-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><p></p><blockquote><p><a href="https://ctftime.org/task/14035"target="_blank">100 digits pin</a> are still too weak... How about 1337 of them?</p></blockquote><h1 id="overview-concept-and-design-criteria">Overview, Concept and Design Criteria</h1><p>This challenge is based on a real-world application. In BalsnCTF 2019, we&apos;ve dealt with PRNG using rejection sampling. This year, we&apos;ve covered another common pattern -- PRNG with a mod.</p><p>One day, @kevin47 found some vuln and asked us if it is possible to break the MT19937 given its output mod some integer, say 10. MT19937 is linear under GF2 vector space, but modulo messed up the relationship completely. The first thing I thought of is modulo power of two, for example, 2^16. But I rejected this idea instantly because it&apos;s too ... CTF, too artificial to be a realistic challenge.</p><p>On my way home, I suddenly realized that half of the integers have a factor of 2, even the example he gave us is! And this challenge borns.</p><h2 id="fun-facts">Fun facts</h2><ul><li>This is the first solved crypto challenge.</li></ul><h1 id="solution">Solution</h1><p><a href="https://github.com/sasdf/ctf/blob/master/tasks/2021/BalsnCTF/crypto/1337pins/_files/deploy/src/server.py"target="_blank">The code</a> is very short. The server generates random digits using <code>random.getrandbits(32) % 10</code>. We can guess 31337 times, and the server will tell us the answer if we send a wrong number. The goal is to make 1337 correct guesses continuously.</p><p>CPython&apos;s random use <a href="https://en.wikipedia.org/wiki/Mersenne_Twister#Algorithmic_detail"target="_blank">MT19937</a> internally, it is linear under GF2 vector space (i.e. Bit vector with xor and shift).</p><p>The modular operation messed up the linearity. Fortunately, modular arithmetic has the following property:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle displaystyle="true"scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true"scriptlevel="0"><mrow><mrow></mrow><mo>(</mo><mi>a</mi><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mi>m</mi><mi>n</mi><mo>)</mo><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mi>n</mi><mtext>&#xA0;</mtext><mo>=</mo><mtext>&#xA0;</mtext><mi>a</mi><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mi>n</mi></mspace></mspace></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true"scriptlevel="0"><mrow><mtext>&#x205F;&#x200A;</mtext><mo>&#x27F9;</mo><mtext>&#x205F;&#x200A;</mtext></mrow></mstyle></mtd><mtd><mstyle displaystyle="true"scriptlevel="0"><mrow><mrow></mrow><mo>(</mo><mi>a</mi><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mn>10</mn><mo>)</mo><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mn>2</mn><mtext>&#xA0;</mtext><mo>=</mo><mtext>&#xA0;</mtext><mi>a</mi><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mn>2</mn></mspace></mspace></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp; (a \mod mn) \mod n\ =\ a \mod n \\ \implies &amp; (a \mod 10) \mod 2\ =\ a \mod 2 \end{aligned}</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"style="height:1.7500000000000002em"><span style="top:-3.91em"><span class="pstrut"style="height:3em"></span><span class="mord"></span></span><span style="top:-2.41em"><span class="pstrut"style="height:3em"></span><span class="mord"><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mrel">&#x27F9;</span><span class="mspace"style="margin-right:.2777777777777778em"></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist"style="height:1.2500000000000002em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"style="height:1.7500000000000002em"><span style="top:-3.91em"><span class="pstrut"style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord mathit">m</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord mathit">n</span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mspace">&#xA0;</span><span class="mrel">=</span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mspace">&#xA0;</span><span class="mord mathit">a</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord mathit">n</span></span></span><span style="top:-2.41em"><span class="pstrut"style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mspace">&#xA0;</span><span class="mrel">=</span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mspace">&#xA0;</span><span class="mord mathit">a</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist"style="height:1.2500000000000002em"><span></span></span></span></span></span></span></span></span></span></span></span> That is, we get the last element in the output GF2 vector.</p><p>We can reconstruct the state by solving the linear equations. There are 19937 equations and 19968 variables. The matrix is quite large and you might run out of time. We have three possible ways to make it faster:</p><ol><li>I simply take the solver from <a href="https://github.com/sasdf/ctf/blob/master/tasks/2021/BalsnCTF/crypto/1337pins/_files/solution/mt"target="_blank">BalsnCTF 2019</a>, it use gaussian elimination and implemented in C++.</li><li>@Utaha <a href="https://utaha1228.github.io/ctf-note/2021/11/21/BalsnCTF-2021/"target="_blank">has reported</a> that using python&apos;s large number is also possible.</li><li>Our verifier, @jwang, use a pre-computed inverse matrix since the relation is always the same.</li></ol><p>You can find our full exploit <a href="https://github.com/sasdf/ctf/blob/master/tasks/2021/BalsnCTF/crypto/1337pins/_files/solution/solve.py"target="_blank">here</a>.</p></section></div></div></div><a href="../../"class="navigation navigation-prev"aria-label="Previous page: Overview"><i class="fa fa-angle-left"></i> </a><a href="../dlog/"class="navigation navigation-next"aria-label="Next page: crypto - dlog"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"1337 pins",category:"crypto",points:422,solves:5,title:"crypto - 1337 pins",level:"10.2.2",depth:2,next:{title:"crypto - dlog",level:"10.2.3",depth:2,path:"tasks/2021/BalsnCTF/crypto/dlog/README.md",ref:"tasks/2021/BalsnCTF/crypto/dlog/README.md",articles:[]},previous:{title:"Overview",level:"10.2.1",depth:2,path:"tasks/2021/BalsnCTF/README.md",ref:"tasks/2021/BalsnCTF/README.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{maxIndexSize:1e6},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf/blob/master",repoPrefix:"https://github.com/sasdf/ctf/blob/master",rawPrefix:"https://raw.githubusercontent.com/sasdf/ctf/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"tasks/2021/BalsnCTF/crypto/1337pins/README.md",mtime:"2021-11-23T18:36:05.957Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2021-11-25T02:55:11.093Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script></body></html>