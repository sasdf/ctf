<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>rev - SecDES Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="../200-AlmightyDuctTape/"rel="next"/><link href="../../crypto/300-xorlnarmoni'akda/"rel="prev"/></head><body><div class="book"><div class="book-summary"><div role="search"id="book-search-input"><input placeholder="Type to search"type="text"/></div><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2018</li><li class="chapter"data-level="3.1"><span>Pwn2Win</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/"><a href="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/">cryrev - Back To Bletchley Park</a></li><li class="chapter"data-level="3.1.2"data-path="../../../../../writeup/2018/pwn2win/crypto/GCM/"><a href="../../../../../writeup/2018/pwn2win/crypto/GCM/">crypto - GCM</a></li></ul></li><li class="chapter"data-level="3.2"><span>HITCON</span><ul class="articles"><li class="chapter"data-level="3.2.1"data-path="../../../../../writeup/2018/hitcon/crypto/lostmod/"><a href="../../../../../writeup/2018/hitcon/crypto/lostmod/">crypto - Lost Modulus</a></li><li class="chapter"data-level="3.2.2"data-path="../../../../../writeup/2018/hitcon/crypto/secret/"><a href="../../../../../writeup/2018/hitcon/crypto/secret/">crypwn - Secret Note</a></li></ul></li><li class="chapter"data-level="3.3"><span>Hack.lu</span><ul class="articles"><li class="chapter"data-level="3.3.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/escape/"><a href="../../../../../writeup/2018/Hack.lu/crypto/escape/">crypto - Escape the Grid</a></li><li class="chapter"data-level="3.3.2"data-path="../../../../../writeup/2018/Hack.lu/crypto/relation/"><a href="../../../../../writeup/2018/Hack.lu/crypto/relation/">crypto - Relations</a></li><li class="chapter"data-level="3.3.3"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/">crypto - LFSR StreamCipher</a><ul class="articles"><li class="chapter"data-level="3.3.3.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html">task description</a></li></ul></li></ul></li><li class="chapter"data-level="3.4"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="3.4.1"data-path="../../../../../writeup/2018/HackOver/crypto/oblivious/"><a href="../../../../../writeup/2018/HackOver/crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="3.4.2"data-path="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/"><a href="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter"data-level="3.4.3"data-path="../../../../../writeup/2018/HackOver/rev/flagmaker/"><a href="../../../../../writeup/2018/HackOver/rev/flagmaker/">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="3.5"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="3.5.1"data-path="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/"><a href="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="3.6"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="3.6.1"data-path="../../../../../writeup/2018/defcamp/rev/validator/"><a href="../../../../../writeup/2018/defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="3.6.2"data-path="../../../../../writeup/2018/defcamp/rev/memsome/"><a href="../../../../../writeup/2018/defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="3.6.3"data-path="../../../../../writeup/2018/defcamp/web/secops/"><a href="../../../../../writeup/2018/defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="3.6.4"data-path="../../../../../writeup/2018/defcamp/web/chat/"><a href="../../../../../writeup/2018/defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="3.6.5"data-path="../../../../../writeup/2018/defcamp/misc/voices/"><a href="../../../../../writeup/2018/defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="3.7"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="3.7.1"data-path="../../../../../writeup/2018/HackIT/coffee_overflow/"><a href="../../../../../writeup/2018/HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../../crypto/100-mama/"><a href="../../crypto/100-mama/">crypto - mama</a></li><li class="chapter"data-level="5.1.2"data-path="../../crypto/200-secureSub/"><a href="../../crypto/200-secureSub/">crypto - secureSub</a></li><li class="chapter"data-level="5.1.3"data-path="../../crypto/300-xorlnarmoni'akda/"><a href="../../crypto/300-xorlnarmoni'akda/">crypto - xorlnarmoni'akda</a></li><li class="chapter active"data-level="5.1.4"data-path="./"><a href="./">rev - SecDES</a></li><li class="chapter"data-level="5.1.5"data-path="../200-AlmightyDuctTape/"><a href="../200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"class="gitbook-link"target="blank">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">rev - SecDES</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="secdes">SecDES</h1><div><span><a href="https://github.com/sasdf/ctf-tasks-writeup/blob/master/tasks/2018/ais3Final/rev/100-SecDES"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="rev - 100"src="https://img.shields.io/badge/rev-100-green.svg?style=for-the-badge&amp;maxAge=3600"></span><span><img alt="0 solves"src="https://img.shields.io/badge/solves-0-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><p></p><blockquote><p>We designed a SecDES algorithm, a secure DES variant. It&apos;s time to make DES great again!!!</p><p>We have two intended solutions for this challenge. If you think there are too few modern cryptography challenges in this CTF and feel bored, here&apos;s another one :) There are some interesting cryptographic properties which can help you solve this challenge faster.</p></blockquote><h1 id="overview-concept-and-design-criteria">Overview, Concept and Design Criteria</h1><p>The challenge name, SecDES, stands for both Secure DES and SHA256 DES.</p><p>This challenge is for simplest reverse 100, so symbols are not stripped, and no obfuscation is applied. It won&apos;t be too hard to reverse the encryption algorithm as I&apos;ve already told you it&apos;s DES.</p><p>In order to make this challenge more interesting, I choose a special encryption key, resulting in two intended solutions for this challenge.</p><h1 id="solution">Solution</h1><h2 id="tldr">TL;DR</h2><p>Feed the encrypted flag to the checker, it will tell you what the plaintext is.</p><h2 id="reversish-solution">Reversish solution</h2><p>This is a modified DES cipher, where the concept of bit is replaced by byte. For example, original DES works on 64 bits data, and our SecDES works on 64 bytes data. All the permutations and key schedule, with the exception of the sbox, are same as original DES. For the sbox in the feistel function, I use SHA256 to reduce 48 bytes expanded data to 32 bytes.</p><p>The program reads 64 bytes of data, encrypt with a hard coded key, and then compare with a encrypted flag. You can solve this challenge by implement a decryption function, extract the key, data, and then decrypt it.</p><h2 id="cryptographic-solution">Cryptographic solution</h2><p>DES has 4 <a href="https://en.wikipedia.org/wiki/Weak_key"target="_blank">weak keys</a> that make encryption function identical to decryption function. That is: <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>(</mo><mi>E</mi><mo>(</mo><mtext>data</mtext><mo>)</mo><mo>)</mo><mo>=</mo><mtext>data</mtext></mrow><annotation encoding="application/x-tex">E(E(\text{data})) = \text{data}</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:1em;vertical-align:-.25em"></span><span class="mord mathit"style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathit"style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord text"><span class="mord">data</span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace"style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut"style="height:.69444em;vertical-align:0"></span><span class="mord text"><span class="mord">data</span></span></span></span></span></span> For more details and the underlying reasons, see the wikipedia page above. If the implementation ignore those 8 parity bits, there are 4 times 2 to the 8 different weak keys.</p><p>The key I chose is one of the weak keys, 0xE1E1E1E1F0F0F0F0. Bit 1 is actually char <code>Y</code>, bit 0 is actually char <code>E</code>, and the parity bits are replaced with <code>AIS3{__}</code>.</p><p>So there&apos;s no need to implement decryption routine by yourself, just feed the encrypted flag to the checker, it will decrypt it for you.</p></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1></div></div></div></div></div></div><a href="../../crypto/300-xorlnarmoni'akda/"class="navigation navigation-prev"aria-label="Previous page: crypto - xorlnarmoni'akda"><i class="fa fa-angle-left"></i> </a><a href="../200-AlmightyDuctTape/"class="navigation navigation-next"aria-label="Next page: rev - Almighty Duct Tape"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"SecDES",category:"rev",points:100,solves:0,title:"rev - SecDES",level:"5.1.4",depth:2,next:{title:"rev - Almighty Duct Tape",level:"5.1.5",depth:2,path:"tasks/2018/ais3Final/rev/200-AlmightyDuctTape/README.md",ref:"tasks/2018/ais3Final/rev/200-AlmightyDuctTape/README.md",articles:[]},previous:{title:"crypto - xorlnarmoni'akda",level:"5.1.3",depth:2,path:"tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/README.md",ref:"tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/README.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf-tasks-writeup/blob/master",repoPrefix:"https://github.com/sasdf/ctf-tasks-writeup/blob/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"tasks/2018/ais3Final/rev/100-SecDES/README.md",mtime:"2018-10-12T20:27:00.448Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2018-12-02T18:03:45.085Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search-engine.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>