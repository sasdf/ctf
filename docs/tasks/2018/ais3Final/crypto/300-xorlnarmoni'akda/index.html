<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>crypto - xorlnarmoni'akda Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="../../rev/100-SecDES/"rel="next"/><link href="../200-secureSub/"rel="prev"/></head><body><div class="book"><div class="book-summary"><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2020</li><li class="chapter"data-level="3.1"><span>Google</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../../../writeup/2020/google/crypto/oracle/"><a href="../../../../../writeup/2020/google/crypto/oracle/">crypto - Oracle</a></li><li class="chapter"data-level="3.1.2"data-path="../../../../../writeup/2020/google/crypto/yafm/"><a href="../../../../../writeup/2020/google/crypto/yafm/">crypto - YAFM</a></li><li class="chapter"data-level="3.1.3"data-path="../../../../../writeup/2020/google/crypto/quantum/"><a href="../../../../../writeup/2020/google/crypto/quantum/">crypto - Quantum Pyramids</a></li><li class="chapter"data-level="3.1.4"data-path="../../../../../writeup/2020/google/crypto/sharky/"><a href="../../../../../writeup/2020/google/crypto/sharky/">crypto - SHArky</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="4.1"><span>Google</span><ul class="articles"><li class="chapter"data-level="4.1.1"data-path="../../../../../writeup/2019/google/crypto/reality/"><a href="../../../../../writeup/2019/google/crypto/reality/">crypto - reality</a></li><li class="chapter"data-level="4.1.2"data-path="../../../../../writeup/2019/google/crypto/qkd/"><a href="../../../../../writeup/2019/google/crypto/qkd/">crypto - Quantum Key Distribution</a></li><li class="chapter"data-level="4.1.3"data-path="../../../../../writeup/2019/google/crypto/cell/"><a href="../../../../../writeup/2019/google/crypto/cell/">crypto - Reverse a cellular automata</a></li><li class="chapter"data-level="4.1.4"data-path="../../../../../writeup/2019/google/hardware/flagrom/"><a href="../../../../../writeup/2019/google/hardware/flagrom/">hardware - flagrom</a></li><li class="chapter"data-level="4.1.5"data-path="../../../../../writeup/2019/google/hardware/minetest/"><a href="../../../../../writeup/2019/google/hardware/minetest/">hardware - minetest</a></li><li class="chapter"data-level="4.1.6"data-path="../../../../../writeup/2019/google/hardware/remote/"><a href="../../../../../writeup/2019/google/hardware/remote/">hardware - Remote Control</a></li><li class="chapter"data-level="4.1.7"data-path="../../../../../writeup/2019/google/web/glotto/"><a href="../../../../../writeup/2019/google/web/glotto/">web - gLotto</a></li><li class="chapter"data-level="4.1.8"data-path="../../../../../writeup/2019/google/rev/dial/"><a href="../../../../../writeup/2019/google/rev/dial/">rev - Dialtone</a></li></ul></li><li class="chapter"data-level="4.2"><span>Plaid</span><ul class="articles"><li class="chapter"data-level="4.2.1"data-path="../../../../../writeup/2019/plaid/crypto/cypress/"><a href="../../../../../writeup/2019/plaid/crypto/cypress/">crypto - SPlaid Cypress</a></li><li class="chapter"data-level="4.2.2"data-path="../../../../../writeup/2019/plaid/rev/bigmaffs/"><a href="../../../../../writeup/2019/plaid/rev/bigmaffs/">rev - big maffs</a></li></ul></li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>hxp</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../../../../../writeup/2018/hxp/crypto/blinder_v2/"><a href="../../../../../writeup/2018/hxp/crypto/blinder_v2/">crypto - blinder_v2</a></li><li class="chapter"data-level="5.1.2"data-path="../../../../../writeup/2018/hxp/crypto/blinder/"><a href="../../../../../writeup/2018/hxp/crypto/blinder/">crypto - blinder</a></li><li class="chapter"data-level="5.1.3"data-path="../../../../../writeup/2018/hxp/crypto/curve/"><a href="../../../../../writeup/2018/hxp/crypto/curve/">crypto - curve12833227</a></li><li class="chapter"data-level="5.1.4"data-path="../../../../../writeup/2018/hxp/crypto/oops/"><a href="../../../../../writeup/2018/hxp/crypto/oops/">crypto - oops2</a></li><li class="chapter"data-level="5.1.5"data-path="../../../../../writeup/2018/hxp/crypto/blind/"><a href="../../../../../writeup/2018/hxp/crypto/blind/">crypto - blind</a></li></ul></li><li class="chapter"data-level="5.2"><span>Pwn2Win</span><ul class="articles"><li class="chapter"data-level="5.2.1"data-path="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/"><a href="../../../../../writeup/2018/pwn2win/rev/back_to_bletchley_park/">cryrev - Back To Bletchley Park</a></li><li class="chapter"data-level="5.2.2"data-path="../../../../../writeup/2018/pwn2win/crypto/GCM/"><a href="../../../../../writeup/2018/pwn2win/crypto/GCM/">crypto - GCM</a></li></ul></li><li class="chapter"data-level="5.3"><span>HITCON</span><ul class="articles"><li class="chapter"data-level="5.3.1"data-path="../../../../../writeup/2018/hitcon/crypto/lostmod/"><a href="../../../../../writeup/2018/hitcon/crypto/lostmod/">crypto - Lost Modulus</a></li><li class="chapter"data-level="5.3.2"data-path="../../../../../writeup/2018/hitcon/crypto/secret/"><a href="../../../../../writeup/2018/hitcon/crypto/secret/">crypwn - Secret Note</a></li></ul></li><li class="chapter"data-level="5.4"><span>Hack.lu</span><ul class="articles"><li class="chapter"data-level="5.4.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/escape/"><a href="../../../../../writeup/2018/Hack.lu/crypto/escape/">crypto - Escape the Grid</a></li><li class="chapter"data-level="5.4.2"data-path="../../../../../writeup/2018/Hack.lu/crypto/relation/"><a href="../../../../../writeup/2018/Hack.lu/crypto/relation/">crypto - Relations</a></li><li class="chapter"data-level="5.4.3"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/">crypto - LFSR StreamCipher</a><ul class="articles"><li class="chapter"data-level="5.4.3.1"data-path="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html"><a href="../../../../../writeup/2018/Hack.lu/crypto/lfsr/task.html">task description</a></li></ul></li></ul></li><li class="chapter"data-level="5.5"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="5.5.1"data-path="../../../../../writeup/2018/HackOver/crypto/oblivious/"><a href="../../../../../writeup/2018/HackOver/crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="5.5.2"data-path="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/"><a href="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter"data-level="5.5.3"data-path="../../../../../writeup/2018/HackOver/rev/flagmaker/"><a href="../../../../../writeup/2018/HackOver/rev/flagmaker/">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="5.6"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="5.6.1"data-path="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/"><a href="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="5.7"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="5.7.1"data-path="../../../../../writeup/2018/defcamp/rev/validator/"><a href="../../../../../writeup/2018/defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="5.7.2"data-path="../../../../../writeup/2018/defcamp/rev/memsome/"><a href="../../../../../writeup/2018/defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="5.7.3"data-path="../../../../../writeup/2018/defcamp/web/secops/"><a href="../../../../../writeup/2018/defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="5.7.4"data-path="../../../../../writeup/2018/defcamp/web/chat/"><a href="../../../../../writeup/2018/defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="5.7.5"data-path="../../../../../writeup/2018/defcamp/misc/voices/"><a href="../../../../../writeup/2018/defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="5.8"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="5.8.1"data-path="../../../../../writeup/2018/HackIT/coffee_overflow/"><a href="../../../../../writeup/2018/HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="7.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="7.1.1"data-path="../100-mama/"><a href="../100-mama/">crypto - mama</a></li><li class="chapter"data-level="7.1.2"data-path="../200-secureSub/"><a href="../200-secureSub/">crypto - secureSub</a></li><li class="chapter active"data-level="7.1.3"data-path="./"><a href="./">crypto - xorlnarmoni'akda</a></li><li class="chapter"data-level="7.1.4"data-path="../../rev/100-SecDES/"><a href="../../rev/100-SecDES/">rev - SecDES</a></li><li class="chapter"data-level="7.1.5"data-path="../../rev/200-AlmightyDuctTape/"><a href="../../rev/200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="header">2019</li><li class="chapter"data-level="8.1"><span>Balsn CTF</span><ul class="articles"><li class="chapter"data-level="8.1.1"data-path="../../../../2019/BalsnCTF/"><a href="../../../../2019/BalsnCTF/">Overview</a></li><li class="chapter"data-level="8.1.2"data-path="../../../../2019/BalsnCTF/crypto/collision/"><a href="../../../../2019/BalsnCTF/crypto/collision/">crypto - collision</a></li><li class="chapter"data-level="8.1.3"data-path="../../../../2019/BalsnCTF/crypto/harc4/"><a href="../../../../2019/BalsnCTF/crypto/harc4/">crypto - harc4</a></li><li class="chapter"data-level="8.1.4"data-path="../../../../2019/BalsnCTF/crypto/unpredictable/"><a href="../../../../2019/BalsnCTF/crypto/unpredictable/">crypto - unpredictable</a></li><li class="chapter"data-level="8.1.5"data-path="../../../../2019/BalsnCTF/pwn/securenote/"><a href="../../../../2019/BalsnCTF/pwn/securenote/">crypwn - securenote</a></li><li class="chapter"data-level="8.1.6"data-path="../../../../2019/BalsnCTF/misc/pyshv1/"><a href="../../../../2019/BalsnCTF/misc/pyshv1/">misc - pyshv1</a></li><li class="chapter"data-level="8.1.7"data-path="../../../../2019/BalsnCTF/misc/pyshv2/"><a href="../../../../2019/BalsnCTF/misc/pyshv2/">misc - pyshv2</a></li><li class="chapter"data-level="8.1.8"data-path="../../../../2019/BalsnCTF/misc/pyshv3/"><a href="../../../../2019/BalsnCTF/misc/pyshv3/">misc - pyshv3</a></li><li class="chapter"data-level="8.1.9"data-path="../../../../2019/BalsnCTF/misc/john/"><a href="../../../../2019/BalsnCTF/misc/john/">misc - john</a></li><li class="chapter"data-level="8.1.10"data-path="../../../../2019/BalsnCTF/rev/plam/"><a href="../../../../2019/BalsnCTF/rev/plam/">rev - plam</a></li><li class="chapter"data-level="8.1.11"data-path="../../../../2019/BalsnCTF/rev/vim/"><a href="../../../../2019/BalsnCTF/rev/vim/">rev - vim</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"target="blank"class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">crypto - xorlnarmoni'akda</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="xorlnarmoniakda">xorlnarmoni&apos;akda</h1><div><span><a href="https://github.com/sasdf/ctf/blob/master/tasks/2018/ais3Final/crypto/300-xorlnarmoni&apos;akda"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="crypto - 300"src="https://img.shields.io/badge/crypto-300-green.svg?style=for-the-badge&amp;maxAge=3600"></span><span><img alt="0 solves"src="https://img.shields.io/badge/solves-0-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><p></p><blockquote><p>Xace fua eno el lex jat fesela. La kinunsaresen rironen ernlarnkael&apos;i lius, cene niurnen asti&apos;e laozia. Pa, liaxo vileti&apos;s moni&apos;akda&apos;i kalzanenon cerkmern...</p><p>Note: The flag of this challenge is in the format of <code>farvil{.+}</code>.</p></blockquote><h1 id="overview-concept-and-design-criteria">Overview, Concept and Design Criteria</h1><p>The key vulnerability is small subgroup attack under multiplicative DHKE. By sending a element in that small group, there won&apos;t be too much possible shared secrets.</p><p>This is a simple modern crytographic challenge, which may deserve 100 points in normal CTF. However, this challenge requires you to have some basic knowledge of number theory, otherwise you won&apos;t even notice the existence of subgroup. I also put some effort to make it more interesting to experienced crypto solvers, such as introducing a guest account, PBKDF2, using flag as password, and the most confusing one: obfuscation by a obsecure language.</p><h2 id="about-the-language">About the language</h2><p>The description and the program of this challenge is written in Lineparine (&#x30EA;&#x30D1;&#x30E9;&#x30A4;&#x30F3;&#x8A9E;, &#x7406;&#x8A9E;), an artificial language created by Fafs F. sashimi. The vulnerability is not related to the language, so it is still solvable if you treat the source code as obfustrated. It just sets the crytographic tone for the whole challenge perfectly :)</p><p>If you are interesting to the meanings, there&apos;s English translation in <code>translation.txt</code>. I&apos;m not a master of Lineparine, I guess there are many mistakes in this challenge. If you know how to write in Lineparine fluently, please help me to improve the challenge :)</p><p>I spent about 10 hours designing this challenge, where 9 hours are used to translate to Lineparine LOL.</p><h1 id="solution">Solution</h1><h2 id="tldr">TL;DR</h2><p>Send a element in a small group and guess the shared secret.</p><p>You need to know some basic group theory.</p><ul><li>The order of finite field <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.974998em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut"style="height:2.7em"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight mathit">p</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist"style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> over prime <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit">p</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p - 1</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathit">p</span><span class="mspace"style="margin-right:.2222222222222222em"></span><span class="mbin">&#x2212;</span><span class="mspace"style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut"style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>. [<a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function"target="_blank">Euler&apos;s totient function</a>]</li><li>A prime number <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">q</span></span></span></span> dividing the order of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">G</mi></mrow><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.68611em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">G</span></span></span></span></span> implies the existence of subgroup with order <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">q</span></span></span></span>. [<a href="https://en.wikipedia.org/wiki/Cauchy%27s_theorem_\(group_theory\"target="_blank">Cauchy&apos;s theorem</a>)]</li><li>The order of every subgroup of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">G</mi></mrow><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.68611em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">G</span></span></span></span></span> divides the order of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">G</mi></mrow><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.68611em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">G</span></span></span></span></span>. [<a href="https://en.wikipedia.org/wiki/Lagrange%27s_theorem_\(group_theory\"target="_blank">Lagrange&apos;s theorem</a>)]</li></ul><p>First we have to check whether <a href="https://factordb.com/index.php?query=119323609506587624817542304473025422967730209036482647504046017790728908960293724554064575627723583087966477807950465152737206042053937640076702861135447697896288188327782825571921648597451715744592415597875243806851163720993697338643314116892802122805512134607232526059008942367872367039947556052857129781787"target="_blank"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit">p</span></span></span></span> is a prime</a>. And then find the order of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.974998em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut"style="height:2.7em"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight mathit">p</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist"style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> by <a href="https://factordb.com/index.php?query=119323609506587624817542304473025422967730209036482647504046017790728908960293724554064575627723583087966477807950465152737206042053937640076702861135447697896288188327782825571921648597451715744592415597875243806851163720993697338643314116892802122805512134607232526059008942367872367039947556052857129781786"target="_blank">factorizing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p - 1</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathit">p</span><span class="mspace"style="margin-right:.2222222222222222em"></span><span class="mbin">&#x2212;</span><span class="mspace"style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut"style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></a>, you will get 2, 49391, and a large prime <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">q</span></span></span></span>. So there&apos;s subgroup with order 2, 49391 and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">q</span></span></span></span>.</p><p>The generator of order 2 subgroup is -1, which cannot be used in this challenge.</p><p>To find an generator of subgroup with order 49391, you can select a random number r that is not 1 or -1, and calculate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">g</span></span></span></span> by: <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mrow><mo>(</mo><mi>p</mi><mo>&#x2212;</mo><mn>1</mn><mo>)</mo><mi mathvariant="normal">/</mi><mn>49391</mn></mrow></msup><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mi>p</mi></mspace></mrow><annotation encoding="application/x-tex">r^{(p - 1) / 49391} \mod p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.938em;vertical-align:0"></span><span class="mord"><span class="mord mathit"style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut"style="height:2.7em"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight mathit">p</span><span class="mtight mbin">&#x2212;</span><span class="mord mtight">1</span><span class="mtight mclose">)</span><span class="mord mtight">/</span><span class="mord mtight">4</span><span class="mord mtight">9</span><span class="mord mtight">3</span><span class="mord mtight">9</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span></span><span class="base"><span class="strut"style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord mathit">p</span></span></span></span></span> Order of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathit"style="margin-right:.03588em">g</span></span></span></span> should be 49391 because that according to Fermet&apos;s little theorem: <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mn>49391</mn></msup><mo>=</mo><msup><mi>r</mi><mrow><mo>(</mo><mi>p</mi><mo>&#x2212;</mo><mn>1</mn><mo>)</mo></mrow></msup><mo>=</mo><mn>1</mn><mspace></mspace><mspace width="1em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>&#x2009;</mtext><mtext>&#x2009;</mtext><mi>p</mi></mspace></mrow><annotation encoding="application/x-tex">g^{49391} = r^{(p - 1)} = 1 \mod p</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:1.0585479999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathit"style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut"style="height:2.7em"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">9</span><span class="mord mtight">3</span><span class="mord mtight">9</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace"style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut"style="height:.938em;vertical-align:0"></span><span class="mord"><span class="mord mathit"style="margin-right:.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut"style="height:2.7em"></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight mathit">p</span><span class="mtight mbin">&#x2212;</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mspace"style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace"style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut"style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace"style="margin-right:1em"></span></span><span class="base"><span class="strut"style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mspace"style="margin-right:.16666666666666666em"></span><span class="mord mathit">p</span></span></span></span></span> This method may output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> with probability of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>49391</mn></mrow><annotation encoding="application/x-tex">1 / 49391</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">4</span><span class="mord">9</span><span class="mord">3</span><span class="mord">9</span><span class="mord">1</span></span></span></span>, if you&apos;re too lucky to get <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html"aria-hidden="true"><span class="base"><span class="strut"style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>, try again.</p><p>The shared secret have only 49391 possible values. You can check which one is correct using sha256 MAC inside the message.</p><h1 id="see-also">See also</h1><p>Small subgroup attack is a very old but common mistake in DH/ECDH is not handled correctly, and it still appears in modern softwares. One most recently example is <a href="https://www.cs.technion.ac.il/~biham/BT/"target="_blank">CVE-2018-5383</a> on Bluetooth pairing, which use a invalid curve of order 2 (Strictly speaking, it actually using another curve which has exactly same arithmetic operation rather than subgroup).</p></section></div></div></div><a href="../200-secureSub/"class="navigation navigation-prev"aria-label="Previous page: crypto - secureSub"><i class="fa fa-angle-left"></i> </a><a href="../../rev/100-SecDES/"class="navigation navigation-next"aria-label="Next page: rev - SecDES"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"xorlnarmoni'akda",category:"crypto",points:300,solves:0,title:"crypto - xorlnarmoni'akda",level:"7.1.3",depth:2,next:{title:"rev - SecDES",level:"7.1.4",depth:2,path:"tasks/2018/ais3Final/rev/100-SecDES/README.md",ref:"tasks/2018/ais3Final/rev/100-SecDES/README.md",articles:[]},previous:{title:"crypto - secureSub",level:"7.1.2",depth:2,path:"tasks/2018/ais3Final/crypto/200-secureSub/README.md",ref:"tasks/2018/ais3Final/crypto/200-secureSub/README.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{maxIndexSize:1e6},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf/blob/master",repoPrefix:"https://github.com/sasdf/ctf/blob/master",rawPrefix:"https://raw.githubusercontent.com/sasdf/ctf/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/README.md",mtime:"2020-08-30T20:59:08.264Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2020-08-30T20:59:19.877Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script></body></html>